<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EconMaster 3000</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;700;800&display=swap');
        body { font-family: 'Assistant', sans-serif; }
        .ltr { direction: ltr; display: inline-block; }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        // הוצאת הכלים מתוך ה-Global Objects של הספריות
        const { useState, useEffect } = React;
        
        // יצירת קומפוננטת אייקון שתעבוד עם Lucide ב-CDN
        const Icon = ({ name, size = 24, className = "" }) => {
            const iconRef = React.useRef(null);
            
            React.useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [name]);

            return <i data-lucide={name} style={{width: size, height: size}} className={className}></i>;
        };

        // --- מאגר מידע ---
        const glossaryData = [
            { term: "MRS", full: "Marginal Rate of Substitution", icon: "refresh-cw", desc: "שיעור תחלופה שולי", simple: "על כמה לאפות אני מוותר בשביל עוד בירה אחת ועדיין נשאר מבסוט באותה מידה.", formal: "היחס בו הצרכן מוכן להחליף מוצר אחד באחר תוך שמירה על אותה רמת תועלת (שיפוע עקומת האדישות)." },
            { term: "MU", full: "Marginal Utility", icon: "smile", desc: "תועלת שולית", simple: "כמה כיף היה הביס האחרון. חוק התועלת השולית הפוחתת: הביס הראשון גן עדן, העשירי - בית חולים.", formal: "תוספת התועלת הנובעת מצריכת יחידה נוספת של המוצר (הנגזרת של פונקציית התועלת)." },
            { term: "MC", full: "Marginal Cost", icon: "flame", desc: "עלות שולית", simple: "כמה עולה לי לייצר *בדיוק עכשיו* עוד מנה אחת (כשכבר הכל רותח והעובד עייף).", formal: "התוספת לעלות הכוללת הנובעת מייצור יחידה נוספת." },
            { term: "AC", full: "Average Cost", icon: "trending-down", desc: "עלות ממוצעת", simple: "כמה עלה לי הכל (כולל השכירות והארנונה) חלקי כמה שמכרתי. בטווח הארוך - זה המחיר המינימלי כדי לשרוד.", formal: "העלות הכוללת (TC) חלקי הכמות המיוצרת (Q)." },
            { term: "Shutdown Rule", full: "כלל הסגירה", icon: "octagon", desc: "מתי סוגרים?", simple: "בטווח הקצר: אם המחיר לא מכסה את ה'שוטף' (AVC). בטווח הארוך: אם הוא לא מכסה את הכל (AC).", formal: "הפירמה תפסיק לייצר בטווח הקצר אם P < min(AVC)." }
        ];

        const learningModules = [
            {
                id: "intro",
                title: "מבוא: למה אנחנו פה?",
                content: (
                    <div className="space-y-4">
                        <h3 className="text-xl font-bold text-blue-800">ברוכים הבאים לקורס "מיקרו-פלאפל"</h3>
                        <p>הכלכלה היא לא רק גרפים מפחידים, היא החיים עצמם! או לפחות, הניסיון הנואש שלנו להבין למה אנחנו תמיד במינוס.</p>
                        <div className="bg-yellow-100 p-4 rounded-lg border-r-4 border-yellow-500 text-right">
                            <strong>הנחת היסוד:</strong> בני אדם רוצים למקסם תועלת (להיות מאושרים), ופירמות רוצות למקסם רווח (לעשות כסף). פשוט, לא?
                        </div>
                    </div>
                )
            },
            {
                id: "consumer",
                title: "הצרכן: הדילמה הנצחית",
                content: (
                    <div className="space-y-4">
                        <h3 className="text-xl font-bold text-green-700">תאוריית הצרכן</h3>
                        <ul className="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>פונקציה ליניארית:</strong> u(x,y) = ax + y.</li>
                            <li><strong>קוב-דאגלס:</strong> u(x,y) = xᵃyᵇ.</li>
                        </ul>
                    </div>
                )
            }
        ];

        const examQuestions = [
            {
                id: 1,
                question: "לשמעון פונקציית תועלת u(x,y) = ax + y. נתון Px=2, Py=3. שמעון צורך רק את מוצר X. מה ניתן להגיד על a?",
                options: ["a < 2/3", "a > 2/3", "a = 1.5", "שמעון שונא את Y"],
                correct: 1,
                explanation: "אם צורכים רק X, אז התועלת לשקל של X גדולה משל Y: a/2 > 1/3 => a > 2/3."
            },
            {
                id: 2,
                question: "מתי יצרן יסגור את המפעל בטווח הקצר?",
                options: ["כשמפסידים כסף", "כש-P < AC", "כש-P < AVC", "כשנגמר הקפה"],
                correct: 2,
                explanation: "אם המחיר לא מכסה אפילו את ההוצאות השוטפות (AVC), סוגרים מיד."
            }
        ];

        // --- סימולטור ---
        const ProductionSimulator = () => {
            const [workers, setWorkers] = useState(1);
            const [price, setPrice] = useState(20);
            const production = Math.floor(10 * Math.sqrt(workers));
            const wage = 100;
            const totalCost = (workers * wage) + 50;
            const profit = (production * price) - totalCost;

            return (
                <div className="bg-white p-6 rounded-lg shadow-md border-t-4 border-yellow-500 w-full max-w-2xl mx-auto">
                    <h2 className="text-xl font-bold mb-4 flex items-center gap-2">
                        <Icon name="shopping-cart" className="text-yellow-600" /> סימולטור הפלאפל
                    </h2>
                    <div className="space-y-4">
                        <label className="block">עובדים: {workers}</label>
                        <input type="range" min="0" max="15" value={workers} onChange={e => setWorkers(+e.target.value)} className="w-full" />
                        <label className="block">מחיר מנה: {price} ₪</label>
                        <input type="range" min="10" max="50" value={price} onChange={e => setPrice(+e.target.value)} className="w-full" />
                        <div className={`p-4 rounded text-center text-2xl font-bold ${profit >= 0 ? 'bg-green-100' : 'bg-red-100'}`}>
                            רווח: {profit} ₪
                        </div>
                    </div>
                </div>
            );
        };

        // --- אפליקציה ראשית ---
        function App() {
            const [tab, setTab] = useState('home');
            const [qIdx, setQIdx] = useState(0);
            const [score, setScore] = useState(0);
            const [answered, setAnswered] = useState(false);

            const renderContent = () => {
                if (tab === 'home') return (
                    <div className="text-center py-20">
                        <Icon name="brain" size={64} className="mx-auto text-blue-600 mb-4" />
                        <h1 className="text-5xl font-black mb-4">אקונו-מאסטר <span className="text-blue-600">3000</span></h1>
                        <p className="text-xl text-gray-600 mb-8">הדרך הכי קלה לעבור מיקרו בלי לבכות.</p>
                        <button onClick={() => setTab('learn')} className="bg-blue-600 text-white px-8 py-3 rounded-full font-bold">התחל ללמוד</button>
                    </div>
                );

                if (tab === 'learn') return (
                    <div className="p-6 max-w-4xl mx-auto space-y-6">
                        {learningModules.map(m => (
                            <div key={m.id} className="bg-white p-6 rounded-xl shadow">
                                <h3 className="text-2xl font-bold mb-4 border-b pb-2">{m.title}</h3>
                                {m.content}
                            </div>
                        ))}
                    </div>
                );

                if (tab === 'simulator') return <div className="py-10"><ProductionSimulator /></div>;

                if (tab === 'exam') {
                    const q = examQuestions[qIdx];
                    return (
                        <div className="p-6 max-w-2xl mx-auto">
                            <div className="bg-white p-8 rounded-2xl shadow-xl">
                                <h2 className="text-xl font-bold mb-6">{q.question}</h2>
                                <div className="space-y-3">
                                    {q.options.map((opt, i) => (
                                        <button key={i} onClick={() => !answered && (setAnswered(true), i === q.correct && setScore(score+1))} 
                                                className={`w-full p-4 rounded-xl border-2 text-right ${answered ? (i === q.correct ? 'bg-green-100 border-green-500' : 'bg-gray-50') : 'hover:bg-blue-50'}`}>
                                            {opt}
                                        </button>
                                    ))}
                                </div>
                                {answered && (
                                    <div className="mt-6 p-4 bg-blue-50 rounded-lg">
                                        <p>{q.explanation}</p>
                                        <button onClick={() => {setAnswered(false); setQIdx((qIdx + 1) % examQuestions.length)}} className="mt-4 bg-blue-600 text-white px-4 py-2 rounded">שאלה הבאה</button>
                                    </div>
                                )}
                            </div>
                        </div>
                    );
                }
            };

            return (
                <div className="min-h-screen flex flex-col md:flex-row">
                    <aside className="bg-slate-900 text-white w-full md:w-64 p-6 flex flex-col">
                        <div className="flex items-center gap-2 text-xl font-bold mb-8">
                            <Icon name="pie-chart" className="text-blue-400" /> EconMaster
                        </div>
                        <nav className="flex-1 space-y-2">
                            <button onClick={() => setTab('home')} className={`w-full text-right p-3 rounded flex items-center gap-2 ${tab==='home'?'bg-blue-600':''}`}><Icon name="home" size={18}/> ראשי</button>
                            <button onClick={() => setTab('learn')} className={`w-full text-right p-3 rounded flex items-center gap-2 ${tab==='learn'?'bg-blue-600':''}`}><Icon name="book-open" size={18}/> לימוד</button>
                            <button onClick={() => setTab('simulator')} className={`w-full text-right p-3 rounded flex items-center gap-2 ${tab==='simulator'?'bg-blue-600':''}`}><Icon name="calculator" size={18}/> סימולטור</button>
                            <button onClick={() => setTab('exam')} className={`w-full text-right p-3 rounded flex items-center gap-2 ${tab==='exam'?'bg-blue-600':''}`}><Icon name="award" size={18}/> מבחן</button>
                        </nav>
                    </aside>
                    <main className="flex-1 overflow-auto">{renderContent()}</main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
